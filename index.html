<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cricket Ground ‚Äî Ledger & Bat Play</title>
<style>
:root {
  --ground-size: 550px;
  --player-size: 64px;
}

html,body{
  height:100%; margin:0; background: linear-gradient(180deg,#073b07 0%, #0a5a0a 60%);
  font-family:Inter,Arial,sans-serif; display:flex; align-items:center; justify-content:center; color:#fff; position:relative;
}
.app{display:flex;gap:24px;padding:20px;box-sizing:border-box;align-items:flex-start;}
.fico-wrap{width:80px;display:flex-direction:column;align-items:center; margin-top:60px;}
.scoreboard{
  width:300px; background: rgba(255,255,255,0.06); border-radius:12px; padding:14px;
  box-shadow:0 8px 22px rgba(0,0,0,0.45); backdrop-filter: blur(4px); margin-top:60px;
}
.scoreboard h2{margin:0 0 12px 0;font-size:20px;text-align:center;}
.score-item{margin:8px 0;font-size:16px;display:flex;justify-content:space-between;}
.ground-wrap{width:var(--ground-size);height:var(--ground-size);position:relative;}
#ground{width:100%;height:100%;border-radius:50%;background:radial-gradient(circle at 40% 30%,#2bbf2b 0%,#138013 45%,#0a5a0a 100%);border:6px solid rgba(255,255,255,0.12);position:relative;overflow:visible;box-shadow:0 18px 40px rgba(0,0,0,0.6), inset 0 6px 12px rgba(255,255,255,0.02);}
#groundCanvas{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;pointer-events:none;}
.pitch{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:40px;height:240px;background:#f3e9d7;border-radius:6px;}
.crease{position:absolute;left:50%;width:80px;height:4px;background:white;transform:translateX(-50%);}
#top-crease{top:calc(50% - 110px);}#bottom-crease{top:calc(50% + 110px);}
.player{width:var(--player-size);height:var(--player-size);position:absolute;transform:translate(-50%,-50%);transition:left 1000ms ease, top 1000ms ease;z-index:120;user-select:none;pointer-events:auto;}
.svg-root{width:100%;height:100%;display:block;}
.bob{animation:bob 1.4s ease-in-out infinite;transform-origin:50% 50%;}
@keyframes bob{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
.bat{transform-origin:46px 26px;transition:transform 260ms ease;}
.bat.swing{transform:rotate(28deg) translate(6px,-4px);}
.player-label{font-size:28px; font-weight:bold; fill:#ffffff; text-anchor:middle; pointer-events:none;}
#ball{width:18px;height:18px;border-radius:50%;background:red;position:absolute;transform:translate(-50%,-50%);transition:left 600ms cubic-bezier(.2,.9,.2,1), top 600ms cubic-bezier(.2,.9,.2,1);z-index:200;box-shadow: 0 6px 12px rgba(0,0,0,0.45), inset 0 -2px 6px rgba(0,0,0,0.18);}
.striker-bounce {animation: bump 0.6s ease;}
@keyframes bump {0% { transform: translateY(0) rotate(0deg); }35% { transform: translateY(-12px) rotate(-6deg); }100% { transform: translateY(0) rotate(0deg); }}
#playBtn{display:block;margin:100px auto 0 auto;width:140px;height:140px;border-radius:50%;border:none;background:#ffd166;color:#000;font-weight:bold;font-size:64px;cursor:pointer;box-shadow:0 6px 12px rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;}

.floating-background-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: rgba(255, 215, 0, 0.1); /* semi-transparent */
  font-size: 15px;
  font-weight: bold;
  text-align: center; /* center multiple lines */
  line-height: 1.2;
  white-space: nowrap;
  z-index: 1; /* behind everything */
  animation: floatBack 10s ease-in-out infinite alternate;
  pointer-events: none;
  text-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
}

@keyframes floatBack {
  0% { transform: translate(-50%, -50%) translateX(-100px); }
  50% { transform: translate(-50%, -50%) translateX(100px); }
  100% { transform: translate(-50%, -50%) translateX(-100px); }
}


</style>
</head>
<body>
<audio id="batSound" src="./cricket_ball_sound.mp3" preload="auto"></audio>
<div class="floating-background-text">
  SAP Cricket<br>Premier League
</div>

<div class="app">
  
  <div>
    <div class="scoreboard">
      <h2>Scoreboard</h2>
      <div class="score-item"><span>Target</span><span id="targetRuns">0</span></div>
      <div class="score-item"><span>Runs</span><span id="runs">0</span></div>
      <div class="score-item"><span>Overs</span><span id="overs">0.0</span></div>
      <div class="score-item"><span>Wickets</span><span id="wickets">0</span></div>
      <div class="score-item"><span>Runs Needed</span><span id="runsNeeded">0</span></div>
    </div>

    <button id="playBtn">üèè</button>
  </div>

  <div class="ground-wrap">
    <div id="ground">
      <canvas id="groundCanvas" width="640" height="640"></canvas>
      <div class="pitch"></div>
      <div id="top-crease" class="crease"></div>
      <div id="bottom-crease" class="crease"></div>
      <div id="ball"></div>
    </div>
  </div>
</div>

<script>
(function(){
const ground=document.getElementById('ground');
const canvas=document.getElementById('groundCanvas');
const ctx=canvas.getContext('2d');
const ballEl=document.getElementById('ball');
const playBtn=document.getElementById('playBtn');

// Scoreboard elements
const runsEl = document.getElementById('runs');
const oversEl = document.getElementById('overs');
const wicketsEl = document.getElementById('wickets');
const targetEl = document.getElementById('targetRuns');
const runsNeededEl = document.getElementById('runsNeeded');

const target = 249;
targetEl.textContent = target;
let runs = 0, overs = 0, wickets = 0, balls = 0, move = 0;
const movesCount = 6;
const runsPerMove = [];
let remaining = target;
for(let i=0;i<movesCount;i++){
  if(i===movesCount-1) runsPerMove.push(remaining);
  else { const r=Math.floor(remaining/(movesCount-i)); runsPerMove.push(r); remaining-=r; }
}

function updateScore(){
  if(move >= movesCount) return;
  const addRuns = runsPerMove[move];
  runs += addRuns;
  balls++;
  overs = (Math.floor(balls/6)) + ((balls%6)/10);
  runsEl.textContent = runs;
  oversEl.textContent = overs.toFixed(1);
  runsNeededEl.textContent = Math.max(target - runs,0);
  move++;
  if(move === 3) wickets = 2;
  if(move === 4) wickets = 3;
  wicketsEl.textContent = wickets;
  
}

function resizeCanvas(){const r=ground.getBoundingClientRect();canvas.width=r.width;canvas.height=r.height;}
resizeCanvas(); window.addEventListener('resize',resizeCanvas);

function createHuman(label,withBat,shirt="#0ea5a3"){
  const wrap=document.createElement('div'); wrap.className='player';
  const batSvg=withBat? `<g class="bat"><rect x="38" y="18" width="18" height="4" rx="2" fill="#b45309"/></g>`:'';
  wrap.innerHTML=`<svg class="svg-root bob" viewBox="0 0 64 64">
    <circle cx="32" cy="12" r="7.5" fill="#ffd7b5"/>
    <rect x="22" y="20" width="20" height="20" rx="4" fill="${shirt}"/>
    <rect x="14" y="22" width="8" height="12" rx="3" fill="${shirt}" transform="rotate(-6 14 22)"/>
    <rect x="42" y="22" width="8" height="12" rx="3" fill="${shirt}" transform="rotate(6 42 22)"/>
    <rect x="24" y="40" width="6" height="14" rx="2" fill="#123"/>
    <rect x="34" y="40" width="6" height="14" rx="2" fill="#123"/>
    ${batSvg}<text x="32" y="60" class="player-label">${label}</text></svg>`;
  ground.appendChild(wrap);
  return wrap;
}

let bowler=createHuman('',false,'#0ea5a3');
let striker=createHuman('SD',true,'#0ea5a3');
let nonStriker=createHuman('FICO',true,'#0ea5a3');
const f1=createHuman('',false,'#0ea5a3');
const f2=createHuman('',false,'#0ea5a3');
const f3=createHuman('',false,'#0ea5a3');
const f4=createHuman('',false,'#0ea5a3');
const f5=createHuman('',false,'#0ea5a3');

function setPos(el,x,y){ el.style.left=x+'px'; el.style.top=y+'px'; }
function setBallAt(el){ ballEl.style.left=el.style.left; ballEl.style.top=el.style.top; }
function placePlayers(){
  const r=ground.getBoundingClientRect();
  const W=r.width,H=r.height,cx=W/2,cy=H/2;
  setPos(bowler,cx,cy-200);
  setPos(striker,cx,cy+110);
  setPos(nonStriker,cx,cy-110);
  setPos(f1,cx+180,cy-60);
  setPos(f2,cx+220,cy+30);
  setPos(f3,cx,cy+200);
  setPos(f4,cx-180,cy+80);
  setPos(f5,cx-180,cy-30);
  setBallAt(bowler);
}
placePlayers();

function drawTrail(fromEl,toEl){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.beginPath();
  ctx.moveTo(parseFloat(fromEl.style.left),parseFloat(fromEl.style.top));
  ctx.lineTo(parseFloat(toEl.style.left),parseFloat(toEl.style.top));
  ctx.strokeStyle='rgba(255,255,255,0.65)';
  ctx.lineWidth=2; ctx.setLineDash([6,6]); ctx.stroke();
  setTimeout(()=>ctx.clearRect(0,0,canvas.width,canvas.height),700);
}
function swingBat(p){ const bat=p.querySelector('.bat'); if(bat){ bat.classList.add('swing'); setTimeout(()=>bat.classList.remove('swing'),300);

const sound = document.getElementById('batSound');
        if(sound){
            sound.currentTime = 0; // restart if already playing
            sound.play();
        }} }
const fielders = [f1,f2,f3,f4,f5];
function pickRandomFielder(){ return fielders[Math.floor(Math.random()*fielders.length)]; }

function labelEl(player){ return player.querySelector('.player-label'); }
function bounceStrikerLabel(newText){
  const lbl = labelEl(striker);
  lbl.classList.remove('striker-bounce');
  void lbl.offsetWidth;
  lbl.textContent = newText;
  lbl.classList.add('striker-bounce');
  setTimeout(()=> lbl.classList.remove('striker-bounce'),600);
}

// Updated verticalSwap to also swap references
function verticalSwap(callback){
  const sTop = parseFloat(striker.style.top);
  const nsTop = parseFloat(nonStriker.style.top);
  const sLeft = parseFloat(striker.style.left);
  const nsLeft = parseFloat(nonStriker.style.left);

  striker.style.transition = 'top 2000ms ease, left 2000ms ease';
  nonStriker.style.transition = 'top 2000ms ease, left 2000ms ease';

  striker.style.top = nsTop+'px';
  striker.style.left = nsLeft+'px';
  nonStriker.style.top = sTop+'px';
  nonStriker.style.left = sLeft+'px';

  // Swap the variables themselves
  const temp = striker;
  striker = nonStriker;
  nonStriker = temp;

  setTimeout(()=>{ if(callback) callback(); },2000);
}

// Sequence state
let seqState = 0;
function applyAfterReturn(){
  switch(seqState){
    case 0: bounceStrikerLabel('MM'); seqState=1; break;
    case 1: verticalSwap(()=>{ seqState=2; }); break;
    case 2: verticalSwap(()=>{ labelEl(striker).textContent='PP'; seqState=3; }); break;
    case 3: bounceStrikerLabel('ABAP'); seqState=4; break;
    case 4: bounceStrikerLabel('SD'); seqState=0; break;
  }
}

// Play button logic
playBtn.addEventListener('click', ()=>{
  if(move >= movesCount) return; // disable after match
  updateScore(); // distribute runs per move

  setBallAt(bowler);
  drawTrail(bowler,striker);
  setTimeout(()=>{ setBallAt(striker); swingBat(striker); },50);

  setTimeout(()=>{
    const f = pickRandomFielder();
    drawTrail(striker,f);
    setTimeout(()=> setBallAt(f),50);

    setTimeout(()=>{
      drawTrail(f,bowler);
      setTimeout(()=>{
        setBallAt(bowler);
        applyAfterReturn();

        if(move === movesCount){
          setTimeout(()=> alert("üèÜ Batting Team Wins!"), 100);
          playBtn.disabled = true;
        }

      },650);
    },700);
  },700);
});
})();
</script>
</body>
</html>


